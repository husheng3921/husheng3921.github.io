[{"title":"布隆过滤器","url":"/2020/03/18/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>布隆过滤器强大的作用就是在大数据集合中判断一个元素是否存在，具有快速、比哈希表节省空间的优点，但具有一定的误判率(判断元素在，它不一定在，概率比较小，但说它不在，则一定不在)。大多数生产环境下是可以接受的。</p>\n<h2 id=\"使用场景\"><a href=\"#使用场景\" class=\"headerlink\" title=\"使用场景\"></a>使用场景</h2><ul>\n<li>网页爬虫对URL的去重，避免爬取相同URL地址</li>\n<li>过滤黑名单，比如有100亿个URL的黑名单，要求对输入的URL进行检测，并判断输入的URL是否属于黑名单中的URL。</li>\n<li>缓存穿透，将所有可能存在的数据缓存放到布隆过滤器中，当黑客访问不存在的缓存时迅速返回避免缓存及DB挂掉;当大量访问的数据不在缓存中会直接打到数据库，导致数据库崩溃。  </li>\n</ul>\n<h2 id=\"布隆过滤器的实现\"><a href=\"#布隆过滤器的实现\" class=\"headerlink\" title=\"布隆过滤器的实现\"></a>布隆过滤器的实现</h2><ul>\n<li>建立bit数组<br> 使用布隆过滤器首先要建立bit数组，位图的方式，节约空间，利用基本的位图数组实现，数组元素值都初始化0，长度为m。</li>\n<li>哈希函数<br> 实现布隆过滤器还需要一组哈希函数f1,f2,..fn</li>\n<li>元素加入布隆过滤器<br> 样本元素集合X，X1经过若干哈希函数计算的值后C1、C2、、Cn；然后对m取模，得到bit数组中的索引，依次将该索引处值赋值1。如图<br> <img src=\"/img/bloom-1.png\" alt=\"\"></li>\n<li>判断元素是否在过滤器中<br> 对于要判断的元素Xi,经过给定哈希函数计算值后取模得到数组索引值index1,index2,,indexn,取出相应索引处的数组元素值，若都为1，则存在布隆过滤器中，否则不存在。  </li>\n</ul>\n<h2 id=\"布隆过滤器参数及误判分析\"><a href=\"#布隆过滤器参数及误判分析\" class=\"headerlink\" title=\"布隆过滤器参数及误判分析\"></a>布隆过滤器参数及误判分析</h2><p>涉及到的参数主要有：<code>bit数组的大小m,哈希函数的个数n,预期失误率p,样本个数N</code>  </p>\n<ul>\n<li>bit数组的大小m<br>如果bit数组的大小m过小，那么将用于建立布隆过滤器的样本全部输入进去之后，所建立出来的布隆过滤器中bit数组中的大部分、乃至全部bit都被标为1，此时误报率将非常高，甚至达到100%，相当于把任何输入放进去，都会判定为true。<br>反之，如果bit数组的大小m过大，又会浪费内存，这与使用布隆过滤器的初衷就相违背了。</li>\n<li>哈希函数的个数n<br>如果哈希函数的个数过多，那么在利用样本建立布隆过滤器的过程中，bit数组中的大部分位置会被迅速填满，导致误报率变大。<br>如果哈希函数的个数过少，那么对各个样本采集的特征过少，也会影响失误率。<br>因此，一定存在一个比较合适的n，使得在bit数组大小m和样本个数N确定的情况下，使得失误率降到一个很低的水平。  </li>\n</ul>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><ul>\n<li><a href=\"https://www.jianshu.com/p/7ce887ab4089\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/7ce887ab4089</a>  </li>\n<li><a href=\"https://github.com/Snailclimb/JavaGuide/blob/master/docs/dataStructures-algorithms/data-structure/bloom-filter.md\" target=\"_blank\" rel=\"noopener\">https://github.com/Snailclimb/JavaGuide/blob/master/docs/dataStructures-algorithms/data-structure/bloom-filter.md</a></li>\n</ul>\n","tags":["海量数据处理"]},{"title":"linux命令行与shell脚本学习4","url":"/2020/03/18/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A04/","content":"","tags":["linux","shell"]},{"title":"linux命令行与shell脚本学习3","url":"/2020/03/18/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A03/","content":"<h2 id=\"用户管理\"><a href=\"#用户管理\" class=\"headerlink\" title=\"用户管理\"></a>用户管理</h2><h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">adduser username 添加新用户</span><br><span class=\"line\">passwd username 为该用户修改密码  </span><br><span class=\"line\">su username  从当前用户切换到username用户  </span><br><span class=\"line\">deluser --remove-home username 删除用户同时删除用户目录</span><br></pre></td></tr></table></figure>\n\n<p>直接使用sudo username 会报错  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz &#x2F;]$ sudo husheng</span><br><span class=\"line\">[sudo] password for husheng:  </span><br><span class=\"line\">husheng is not in the sudoers file.  This incident will be reported.</span><br></pre></td></tr></table></figure>\n\n<p>执行以下命令进行修改：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">vim &#x2F;etc&#x2F;sudoers  </span><br><span class=\"line\">加入</span><br><span class=\"line\">youuser            ALL&#x3D;(ALL)                ALL</span><br><span class=\"line\">%youuser           ALL&#x3D;(ALL)                ALL</span><br><span class=\"line\">youuser            ALL&#x3D;(ALL)                NOPASSWD: ALL</span><br><span class=\"line\">%youuser           ALL&#x3D;(ALL)                NOPASSWD: ALL</span><br><span class=\"line\">第一行:允许用户youuser执行sudo命令(需要输入密码).</span><br><span class=\"line\">第二行:允许用户组youuser里面的用户执行sudo命令(需要输入密码).</span><br><span class=\"line\">第三行:允许用户youuser执行sudo命令,并且在执行的时候不输入密码.</span><br><span class=\"line\">第四行:允许用户组youuser里面的用户执行sudo命令,并且在执行的时候不输入密码.</span><br></pre></td></tr></table></figure>\n<h3 id=\"sudo以root身份运行\"><a href=\"#sudo以root身份运行\" class=\"headerlink\" title=\"sudo以root身份运行\"></a>sudo以root身份运行</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo husheng husheng 暂时以root身份使用  </span><br><span class=\"line\">sudo su切换到root用户</span><br><span class=\"line\">su husheng 切换到husheng身份</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"用户组管理\"><a href=\"#用户组管理\" class=\"headerlink\" title=\"用户组管理\"></a>用户组管理</h2><h3 id=\"用户组命令\"><a href=\"#用户组命令\" class=\"headerlink\" title=\"用户组命令\"></a>用户组命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">addgroup groupname 添加用户组  </span><br><span class=\"line\">usermod -l username 修改用户名</span><br><span class=\"line\">usermod -g groupname username 将username用户更新到groupname组，</span><br><span class=\"line\">同时会删除原来的用户组  </span><br><span class=\"line\">若不想离开原来的用户组 需加上-a </span><br><span class=\"line\">usermod -ag groupname1 username  </span><br><span class=\"line\">delgroup groupname 删除用户组</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"修改文件所有者和群组\"><a href=\"#修改文件所有者和群组\" class=\"headerlink\" title=\"修改文件所有者和群组\"></a>修改文件所有者和群组</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ ll</span><br><span class=\"line\">total 0</span><br><span class=\"line\">-rw-rw-r-- 1 husheng husheng 0 Mar 18 13:14 hs2.txt</span><br><span class=\"line\">-rw-rw-r-- 1 husheng husheng 0 Mar 18 13:13 hs.txt</span><br><span class=\"line\"></span><br><span class=\"line\">文件都属于用户husheng和用户组husheng  </span><br><span class=\"line\">chown 用户 文件 change own 缩写  </span><br><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ sudo chown isip hs.txt  </span><br><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ ll</span><br><span class=\"line\">total 0</span><br><span class=\"line\">-rw-rw-r-- 1 husheng husheng 0 Mar 18 13:14 hs2.txt</span><br><span class=\"line\">-rw-rw-r-- 1 isip    husheng 0 Mar 18 13:13 hs.txt</span><br><span class=\"line\">看到hs.txt 改成用户 isip  </span><br><span class=\"line\"></span><br><span class=\"line\">chgrp 用户组 文件  </span><br><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ sudo chgrp isip hs.txt  </span><br><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ ll</span><br><span class=\"line\">total 0</span><br><span class=\"line\">-rw-rw-r-- 1 husheng husheng 0 Mar 18 13:14 hs2.txt</span><br><span class=\"line\">-rw-rw-r-- 1 isip    isip    0 Mar 18 13:13 hs.txt  </span><br><span class=\"line\"></span><br><span class=\"line\">chown -R oscar:oscar &#x2F;home&#x2F;thomas 将文件夹递归改变用户和用户组</span><br></pre></td></tr></table></figure>\n<h2 id=\"修改用户权限\"><a href=\"#修改用户权限\" class=\"headerlink\" title=\"修改用户权限\"></a>修改用户权限</h2><h3 id=\"权限原理\"><a href=\"#权限原理\" class=\"headerlink\" title=\"权限原理\"></a>权限原理</h3><p>用命令行ll  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[husheng@izwz9853xzzbsd0y95igboz ~]$ ll</span><br><span class=\"line\">total 4</span><br><span class=\"line\">-rw-rw-r-- 1 husheng husheng    0 Mar 18 13:14 hs2.txt</span><br><span class=\"line\">-rw-rw-r-- 1 isip    isip       0 Mar 18 13:13 hs.txt</span><br><span class=\"line\">drwxrwxr-x 2 husheng husheng 4096 Mar 18 13:42 test</span><br></pre></td></tr></table></figure>\n<ul>\n<li>d：英语 directory 的缩写，表示”目录”。就是说这是一个目录；</li>\n<li>l：英语 link 的缩写，表示”链接”。就是说这是一个链接；</li>\n<li>r：英语 read 的缩写，表示”读”。就是说可以读这个文件；</li>\n<li>w：英语 write 的缩写，表示”写”。就是说可以写这个文件，也就是可以修改；</li>\n<li>x：英语 execute 的缩写，表示”执行，运行”。就是说可以运行这个文件。</li>\n</ul>\n<p>文件访问权限结构：<br><img src=\"/img/linux-3-1.jpg\" alt=\"\"></p>\n<h3 id=\"用数字修改权限-chmod\"><a href=\"#用数字修改权限-chmod\" class=\"headerlink\" title=\"用数字修改权限 chmod\"></a>用数字修改权限 chmod</h3><p>linux为每种权限对应了数字<br>| 权限 | 数字|<br>|– |–|<br>|r | 4|<br>|w |2 |<br>|x | 1|</p>\n<p>合并权限数字组合，<br>|权限|数字|计算|<br>|–|–|–|<br>|—|0|0+0+0|<br>|r–|4|4+0+0|<br>|-w-|2|0+2+0|<br>|–x|1|0+0+1|<br>|rw-|6|4+2+0|<br>|-wx|3|0+2+1|<br>|r-x|5|4+0+1|<br>|rwx|7|4+2+1|</p>\n<h3 id=\"字母分配权限chmod\"><a href=\"#字母分配权限chmod\" class=\"headerlink\" title=\"字母分配权限chmod\"></a>字母分配权限chmod</h3><ul>\n<li>u：user 的缩写，是英语”用户”的意思。表示所有者；</li>\n<li>g：group 的缩写，是英语”群组”的意思。表示群组用户；</li>\n<li>o：other 的缩写，是英语”其他”的意思。表示其他用户；</li>\n<li>a：all 的缩写，是英语”所有”的意思。表示所有用户。</li>\n</ul>\n<p>和这些字母配合的还有几个符号：</p>\n<ul>\n<li>+：加号，表示添加权限；</li>\n<li>-：减号，表示去除权限；</li>\n<li>=：等号，表示分配权限。</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#文件 file.txt 的所有者增加读和运行的权限。</span><br><span class=\"line\">chmod u+rx file.txt</span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的群组其他用户增加读的权限。</span><br><span class=\"line\">chmod g+r file.txt </span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的其他用户移除读的权限。</span><br><span class=\"line\">chmod o-r file.txt </span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的群组其他用户增加读的权限，其他用户移除读的权限。</span><br><span class=\"line\">chmod g+r o-r file.txt </span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的群组其他用户和其他用户均移除读的权限。</span><br><span class=\"line\">chmod go-r file.txt </span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的所有用户增加运行的权限。</span><br><span class=\"line\">chmod +x file.txt </span><br><span class=\"line\"></span><br><span class=\"line\">#文件 file.txt 的所有者分配读，写和执行的权限；</span><br><span class=\"line\">#群组其他用户分配读的权限，不能写或执行；</span><br><span class=\"line\">#其他用户没有任何权限。</span><br><span class=\"line\">chmod u&#x3D;rwx,g&#x3D;r,o&#x3D;- file.txt</span><br></pre></td></tr></table></figure>\n<p>递归修改访问权限 -R</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">chmod -R 700 &#x2F;home&#x2F;oscar</span><br></pre></td></tr></table></figure>","tags":["linux","shell"]},{"title":"数据库连接池技术概述","url":"/2020/03/18/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0/","content":"<h2 id=\"数据库连接池技术\"><a href=\"#数据库连接池技术\" class=\"headerlink\" title=\"数据库连接池技术\"></a>数据库连接池技术</h2><p>所谓的数据库连接池技术就是用来分配、管理、释放数据库连接的。虽然我们直接用JDBC就能够实现这些功能，每次使用jdbc时先获取连接，打开连接，使用完关闭连接，下一次使用时再次打开连接；实际上数据库连接资源是非常宝贵的，平时的小型项目我们可能看不出来，但是实际大型项目中，频繁的打开和关闭数据库连接是对服务器的一种摧残，十分影响效率，而数据库连接池是怎样做的呢？思路是：初始化分配一定的连接数，用户请求时从池中取出，用户用完后回收到池中。一个简答的示意图如下：<br><img src=\"/img/dbpool-1.png\" alt=\"\"></p>\n<h2 id=\"数据库连接池的优点\"><a href=\"#数据库连接池的优点\" class=\"headerlink\" title=\"数据库连接池的优点\"></a>数据库连接池的优点</h2><h3 id=\"资源重用\"><a href=\"#资源重用\" class=\"headerlink\" title=\"资源重用\"></a>资源重用</h3><p>由于数据库连接池得以重用，避免了频繁创建、释放引起大量性能开销。</p>\n<h3 id=\"更快的系统反应速度\"><a href=\"#更快的系统反应速度\" class=\"headerlink\" title=\"更快的系统反应速度\"></a>更快的系统反应速度</h3><p>数据库连接池在初始化过程中，往往已经创建了若干数据库连接置于连接池中备用。此时连接的初始化工作均已完成。对于业务请求处理而言，直接利用现有可用连接，避免了数据库连接初始化和释放过程的时间开销，从而减少了系统的响应时间。</p>\n<h3 id=\"统一的连接管理，避免数据库连接泄露\"><a href=\"#统一的连接管理，避免数据库连接泄露\" class=\"headerlink\" title=\"统一的连接管理，避免数据库连接泄露\"></a>统一的连接管理，避免数据库连接泄露</h3><p>在较为完善的数据库连接池中，可根据预先的占用时间设置超时强制回收，从而避免了常规数据库连接操作中可能出现的资源泄露。</p>\n<h2 id=\"自己实现一个简单的数据库连接池\"><a href=\"#自己实现一个简单的数据库连接池\" class=\"headerlink\" title=\"自己实现一个简单的数据库连接池\"></a>自己实现一个简单的数据库连接池</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">@Slf4j</span><br><span class=\"line\">public class MyDBPool &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    private final int init_count &#x3D; 3; &#x2F;&#x2F;初始化链接数目</span><br><span class=\"line\">    private final int max_count &#x3D; 6; &#x2F;&#x2F;最大</span><br><span class=\"line\">    private int current_count &#x3D; 0; &#x2F;&#x2F;到当前连接数</span><br><span class=\"line\">    private static final String DBDRIVER &#x3D; &quot;com.mysql.jdbc.Driver&quot; ;            &#x2F;&#x2F;驱动类类名</span><br><span class=\"line\">    private static final String DBURL &#x3D; &quot;jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;springlearn?serverTimezone&#x3D;UTC&amp;useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;useSSL&#x3D;false&quot;;&#x2F;&#x2F;连接URL</span><br><span class=\"line\">    private static final String DBUSER &#x3D; &quot;root&quot; ;                                &#x2F;&#x2F;数据库用户名</span><br><span class=\"line\">    private static final String DBPASSWORD &#x3D; &quot;hs3921&quot;;</span><br><span class=\"line\">    &#x2F;&#x2F;连接池，用来存放初始化链接</span><br><span class=\"line\">    private LinkedList&lt;Connection&gt; pool &#x3D; new LinkedList&lt;Connection&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F;构造函数，初始化链接放入连接池</span><br><span class=\"line\">    public MyDBPool() &#123;</span><br><span class=\"line\">        for (int i&#x3D;0;i&lt;init_count;i++)&#123;</span><br><span class=\"line\">            &#x2F;&#x2F;记录当前连接数</span><br><span class=\"line\">            current_count++;</span><br><span class=\"line\">            Connection connection &#x3D; createConnection();</span><br><span class=\"line\">            pool.addLast(connection);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F;创建新的连接</span><br><span class=\"line\">    public Connection createConnection() &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Class.forName(DBDRIVER);</span><br><span class=\"line\">            Connection connection &#x3D; DriverManager.getConnection(DBURL, DBUSER, DBPASSWORD);</span><br><span class=\"line\">            return connection;</span><br><span class=\"line\">        &#125;catch (Exception e)&#123;</span><br><span class=\"line\">            log.info(&quot;数据库链接异常&quot;);</span><br><span class=\"line\">            throw new RuntimeException();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F;获取链接</span><br><span class=\"line\">    public Connection getConnection() &#123;</span><br><span class=\"line\">        if (pool.size() &gt; 0)&#123;</span><br><span class=\"line\">            &#x2F;&#x2F;removeFirst删除第一个并且返回</span><br><span class=\"line\">            return pool.removeFirst();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (current_count &lt; max_count)&#123;</span><br><span class=\"line\">            &#x2F;&#x2F;记录当前使用的连接数</span><br><span class=\"line\">            current_count++;</span><br><span class=\"line\">            &#x2F;&#x2F;创建链接</span><br><span class=\"line\">            return createConnection();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        throw new RuntimeException(&quot;当前链接已经达到最大连接数&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;&#x2F;释放链接</span><br><span class=\"line\">    public void releaseConnection(Connection connection)&#123;</span><br><span class=\"line\">        if (pool.size() &lt; init_count)&#123;</span><br><span class=\"line\">            pool.addLast(connection);</span><br><span class=\"line\">            current_count--;</span><br><span class=\"line\">        &#125;else &#123;</span><br><span class=\"line\">            try &#123;</span><br><span class=\"line\">                connection.close();</span><br><span class=\"line\">            &#125; catch (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><p><a href=\"https://juejin.im/post/5b7944c6e51d4538c86cf195\" target=\"_blank\" rel=\"noopener\">https://juejin.im/post/5b7944c6e51d4538c86cf195</a></p>\n","tags":["数据库连接池"]},{"title":"DBCP数据库连接池失效","url":"/2020/03/18/DBCP%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E5%A4%B1%E6%95%88/","content":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在项目中，spring框架，使用的是dbcp数据库连接池，数据库是mysql，项目部署测试期间，过了一晚上不登录和使用，第二天首次登录(账号、密码正确)会报登录错误，但是再次点击登录会登录成功，查看tomcat日志发现communication connection timeout，数据库连接超时。</p>\n<h2 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h2><p>当时网上找了很多解决办法，都是改些dbcp的时间配置，改了之后，过一天测试还是没用，最后找到了配置如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;bean id&#x3D;&quot;dataSource&quot; class&#x3D;&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span><br><span class=\"line\">        destroy-method&#x3D;&quot;close&quot;</span><br><span class=\"line\">        p:driverClassName&#x3D;&quot;com.mysql.jdbc.Driver&quot;</span><br><span class=\"line\">        p:url&#x3D;&quot;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;ychbh&quot;</span><br><span class=\"line\">        p:username&#x3D;&quot;root&quot;</span><br><span class=\"line\">        p:password&#x3D;&quot;xxxx&quot;</span><br><span class=\"line\">        p:validationQuery&#x3D;&quot;SELECT 1&quot;</span><br><span class=\"line\">        p:testOnBorrow&#x3D;&quot;true&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure>\n<p>加了<code>validationQuery=&quot;SELECT 1&quot;,testOnBorrow=&quot;true&quot;</code>查看dbcp两个属性源码  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#x2F;**</span><br><span class=\"line\">     * Sets the &#123;@link #testOnBorrow&#125; property. This property determines</span><br><span class=\"line\">     * whether or not the pool will validate objects before they are borrowed</span><br><span class=\"line\">     * from the pool. For a &lt;code&gt;true&lt;&#x2F;code&gt; value to have any effect, the </span><br><span class=\"line\">     * &lt;code&gt;validationQuery&lt;&#x2F;code&gt; property must be set to a non-null string.</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @param testOnBorrow new value for testOnBorrow property</span><br><span class=\"line\">     *&#x2F;</span><br><span class=\"line\">    public synchronized void setTestOnBorrow(boolean testOnBorrow) &#123;</span><br><span class=\"line\">        this.testOnBorrow &#x3D; testOnBorrow;</span><br><span class=\"line\">        if (connectionPool !&#x3D; null) &#123;</span><br><span class=\"line\">            connectionPool.setTestOnBorrow(testOnBorrow);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">源码中的注释指testOnBorrow 指明在从池中取出连接前进行检验,校验连接是否有效，</span><br><span class=\"line\">如果检验无效,则从池中去除连接并尝试取出另一个. 设置true表示进行校验，</span><br><span class=\"line\">同时要设置validationQuery 该选项用来验证数据库连接的有效性</span><br><span class=\"line\"> &#x2F;**</span><br><span class=\"line\">     * The SQL query that will be used to validate connections from this pool</span><br><span class=\"line\">     * before returning them to the caller.  If specified, this query</span><br><span class=\"line\">     * &lt;strong&gt;MUST&lt;&#x2F;strong&gt; be an SQL SELECT statement that returns at least</span><br><span class=\"line\">     * one row.</span><br><span class=\"line\">     *&#x2F;</span><br><span class=\"line\">    protected volatile String validationQuery &#x3D; null;</span><br><span class=\"line\">注释中说这个SQL查询会校验来自连接池中的连接是否有效，如果指定，这个查询必须返回最少一行，</span><br><span class=\"line\">也就是项目中报的错-数据库连接超时，现在有了这两条属性，数据库连接时会自己校验这个连接是否有效而不是抛给用户；</span><br><span class=\"line\">项目中未修改配置前我们第一次点报连接超时，第二次点击登录成功，说明我们第一次点击相当于执行了检验连接无效，</span><br><span class=\"line\">第二次重新获取新的连接，但是这个不应该抛给用户，应由连接池来检验。</span><br></pre></td></tr></table></figure>\n<h2 id=\"深层次原因\"><a href=\"#深层次原因\" class=\"headerlink\" title=\"深层次原因\"></a>深层次原因</h2><p>MySQL默认设置下，当一个连接超过8小时后，Mysql会自动断开连接；而DBCP连接池依然认为断开的连接有效。<br>既然是这样子，那我们程序员在对数据库操作前，需要对数据库连接做个校验或判断是否有效，也就是dbcp上面加了两个属性。这里附上C3p0的配置。  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#c3p0配置</span><br><span class=\"line\">&lt;!--最大空闲时间，60秒内未使用则连接被丢弃。若为0则永不丢弃。默认值: 0 --&gt;   </span><br><span class=\"line\">&lt;property name&#x3D;&quot;maxIdleTime&quot;&gt;60&lt;&#x2F;property&gt;  </span><br><span class=\"line\">&lt;!-- 当连接池连接耗尽时，客户端调用getConnection()后等待获取新连接的时间，</span><br><span class=\"line\">超时后将抛出SQLException，如设为0则无限期等待。单位毫秒。默认: 0 --&gt;   </span><br><span class=\"line\">&lt;property name&#x3D;&quot;checkoutTimeout&quot; value&#x3D;&quot;3000&quot;&#x2F;&gt;  </span><br><span class=\"line\">&lt;!--c3p0将建一张名为Test的空表，并使用其自带的查询语句进行测试。</span><br><span class=\"line\">如果定义了这个参数那么属性preferredTestQuery将被忽略。</span><br><span class=\"line\">你不能在这张Test表上进行任何操作，它将只供c3p0测试使用。默认值: null --&gt;   </span><br><span class=\"line\"> &lt;property name&#x3D;&quot;automaticTestTable&quot;&gt;Test&lt;&#x2F;property&gt;  </span><br><span class=\"line\">&lt;!--因性能消耗大请只在需要的时候使用它。如果设为true那么在每个connection提交的   </span><br><span class=\"line\">　　时候都将校验其有效性。建议使用idleConnectionTestPeriod或automaticTestTable   </span><br><span class=\"line\">　　等方法来提升连接测试的性能。Default: false --&gt;   </span><br><span class=\"line\">&lt;property name&#x3D;&quot;testConnectionOnCheckout&quot;&gt;false&lt;&#x2F;property&gt;   </span><br><span class=\"line\">&lt;!--如果设为true那么在取得连接的同时将校验连接的有效性。Default: false --&gt;   </span><br><span class=\"line\">&lt;property name&#x3D;&quot;testConnectionOnCheckin&quot;&gt;true&lt;&#x2F;property&gt; </span><br><span class=\"line\">&lt;!--每60秒检查所有连接池中的空闲连接。Default: 0 --&gt;   </span><br><span class=\"line\">&lt;property name&#x3D;&quot;idleConnectionTestPeriod&quot;&gt;60&lt;&#x2F;property&gt;</span><br></pre></td></tr></table></figure>","tags":["数据库连接池"]},{"title":"git常用命令总结","url":"/2020/03/03/git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/","content":"<h2 id=\"概览\"><a href=\"#概览\" class=\"headerlink\" title=\"概览\"></a>概览</h2><p><img src=\"/img/git-1-1.png\" alt=\"\"></p>\n<ul>\n<li>工作区 Workspace  </li>\n<li>暂存区index/stage  </li>\n<li>本地仓库 repository  </li>\n<li>远程仓库 remote  </li>\n</ul>\n<h2 id=\"修改\"><a href=\"#修改\" class=\"headerlink\" title=\"修改\"></a>修改</h2><h3 id=\"暂存修改\"><a href=\"#暂存修改\" class=\"headerlink\" title=\"暂存修改\"></a>暂存修改</h3><p>操作一览表  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">创建stash    git stash  </span><br><span class=\"line\">删除         git stash drop stash@&#123;num&#125;  </span><br><span class=\"line\">应用         git stash apply stash@&#123;num&#125;  </span><br><span class=\"line\">查看         git stash list  </span><br><span class=\"line\">还原上一个暂存并删除暂存(如无conflict)    git stash pop</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"撤销修改\"><a href=\"#撤销修改\" class=\"headerlink\" title=\"撤销修改\"></a>撤销修改</h3><ul>\n<li>还未提交到暂存区<br>即还没有使用git add ,可以使用<br><code>git checkout -- filename.txt</code><br>丢弃当前工作区文件的修改，文件参数也可以是* 放弃全部。</li>\n<li>还未提交仓库<br>已经add到暂存，但是为commit可以使用  <figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">git reset HEAD filename.txt  </span><br><span class=\"line\">git checkout -- filename.txt</span><br></pre></td></tr></table></figure>\n先reset撤掉暂存区（add反操作），然后再checkout撤回工作区。</li>\n<li>已提交到仓库<br>可以指定版本回退<br><code>git reset --hard xxx版本号</code>  </li>\n<li>撤销之前某次提交<br>git revert撤销一个提交的同时会创建一个新的提交，这是一个安全的方法，因为它不会重写提交历史。但实现上和reset是完全不同的。它撤销这个提交引入的更改，然后在最后加上一个撤销了更改的新提交，而不是从项目历史中移除这个提交。<br><code>git revert 46af7z6</code><br>相较于 reset ， revert不会改变项目历史，对那些已经发布到共享仓库的提交来说这是一个安全的操作。其次 git revert 可以将提交历史中的任何一个提交撤销、而 reset会把历史上某个提交及之后所有的提交都移除掉，这太野蛮了。<br>相比 reset，它不会改变现在的提交历史。因此， revert 可以用在公共分支上， reset 应该用在私有分支上。<h2 id=\"分支操作\"><a href=\"#分支操作\" class=\"headerlink\" title=\"分支操作\"></a>分支操作</h2><h3 id=\"创建-查看-合并分支\"><a href=\"#创建-查看-合并分支\" class=\"headerlink\" title=\"创建/查看/合并分支\"></a>创建/查看/合并分支</h3>操作一览  <table>\n<thead>\n<tr>\n<th>操作</th>\n<th>命令</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>查看分支</td>\n<td>git branch</td>\n</tr>\n<tr>\n<td>查看本地和远程分支</td>\n<td>git branch -a</td>\n</tr>\n<tr>\n<td>在target分支上创建分支，没有则从当前分支</td>\n<td>git branch &lt;branch-name&gt; &lt;target-branch&gt;</td>\n</tr>\n<tr>\n<td>创建并切换分支</td>\n<td>git checkout -b &lt;branch-name&gt;</td>\n</tr>\n<tr>\n<td>合并某分支到当前分支</td>\n<td>git merge &lt;branch-name&gt;</td>\n</tr>\n<tr>\n<td>删除分支，只能删参与了合并的</td>\n<td>git branch -d &lt;branch-name&gt;</td>\n</tr>\n<tr>\n<td>强行删除</td>\n<td>git branch -D &lt;branch-name&gt;</td>\n</tr>\n<tr>\n<td>删除远程分支</td>\n<td>git push origin –delete &lt;remote-branch-name&gt;</td>\n</tr>\n<tr>\n<td>显示远程分支</td>\n<td>git remote show origin</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<h2 id=\"配置多个远程仓库\"><a href=\"#配置多个远程仓库\" class=\"headerlink\" title=\"配置多个远程仓库\"></a>配置多个远程仓库</h2><p><code>git remote set-url --add origin https://github.com/78778443/gittest.git</code>  </p>\n<h2 id=\"覆盖远程仓库\"><a href=\"#覆盖远程仓库\" class=\"headerlink\" title=\"覆盖远程仓库\"></a>覆盖远程仓库</h2><p><code>本地仓库版本落后于远程仓库版本时，  \ngit push -f 强制推送</code></p>\n<h2 id=\"查看操作日志\"><a href=\"#查看操作日志\" class=\"headerlink\" title=\"查看操作日志\"></a>查看操作日志</h2><pre><code>git relog 查看操作日志，git log 只能查看版本日志  \ngit checkout -b  retest_v3  b52b955 找回分支 后两项：分支名称，提交id</code></pre><h2 id=\"rebase\"><a href=\"#rebase\" class=\"headerlink\" title=\"rebase\"></a>rebase</h2><ul>\n<li>git merge命令合并代码之后，版本记录会按照时间顺序排序，并自动产生一个Merge branch的版本；</li>\n<li>git rebase命令合并代码之后，版本记录会将目标分支的版本放在后面，然后再将当前分支的版本记录放在前边。</li>\n</ul>\n","tags":["git"]},{"title":"linux命令行与shell脚本学习2","url":"/2020/03/03/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A02/","content":"<h1 id=\"文件操作\"><a href=\"#文件操作\" class=\"headerlink\" title=\"文件操作\"></a>文件操作</h1><h3 id=\"文件组织\"><a href=\"#文件组织\" class=\"headerlink\" title=\"文件组织\"></a>文件组织</h3><p>root根目录下： </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[root@node1 &#x2F;]# ls</span><br><span class=\"line\">bin  boot  dev  dfs  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/linux-2-1.png\" alt=\"\">  </p>\n<ul>\n<li>bin：英语 binary 的缩写，表示”二进制文件”（我们知道可执行文件是二进制的）。包含了会被所有用户使用的可执行程序；</li>\n<li>boot：英语 boot 表示”启动”，包含与 Linux 启动密切相关的文件；</li>\n<li>dev：英语 device 的缩写，表示”设备”，包含外设。它里面的子目录，每一个对应一个外设。比如代表我们的光盘驱动器的文件就会出现在这个目录下面；</li>\n<li>etc：etc 有点不能顾名思义了。因为 etc 是法语 et cetera 的缩写，翻成英语就是”and so on”，表示”…等等”，包含系统的配置文件。至于为什么在 /etc 下面存放配置文件， 按照原始的 Unix 说法（Linux 文件结构参考 Unix 的教学实现 MINIX），这下面放的都是一堆零零碎碎的东西， 就叫 etc 好了。哈哈 ，这其实是个历史遗留；</li>\n<li>home：英语 home 表示”家”，用户的私人目录。之前我们提过一些，在这个目录中，我们放置私人的文件，有点类似 Windows 中的 Documents 这个文件夹，也叫”我的文档”。Linux 中的每个用户（除了大管家用户，也就是超级用户 root 外。root 因为太厉害，拥有所有权限，所以比较”任性”，跟普通用户不住在一起）都在 home 目录下有自己的一个私人目录。比如我的用户名是 oscar，那么我的私人目录就是 /home/oscar；如果另一个用户叫 john，那么他的私人目录就是 /home/john；</li>\n<li>lib：英语 library 的缩写，表示”库”，包含被程序所调用的库文件。例如 .so 结尾的文件，在 Windows 下这样的库文件是以 .dll 结尾的；</li>\n<li>media：英语 media 表示”媒体”。当一个可移动的外设（比如 USB 盘、SD 卡、DVD、光盘等等）插入电脑时，Linux 就可以让我们通过 media 的子目录来访问这些外设中的内容。</li>\n<li>mnt：英语 mount 的缩写，表示”挂载”。有点类似 media，但一般用于临时挂载一些装置；</li>\n<li>opt：英语 optional application software package 的缩写，表示”可选的应用软件包”，用于安装多数第三方软件和插件；</li>\n<li>root：英语”根”的意思。超级用户 root 的家目录/主目录。一般用户的家目录是位于 /home 下，不过 root 用户是个例外。之前的课程我们也提到过，root 是整个系统的超级用户，拥有一切权限，初学者请慎用此用户模式；</li>\n<li>sbin：英语 system binary 的缩写，表示”系统二进制文件”。比起 bin 目录多了一个前缀 system，所以包含的是系统级的重要可执行程序；</li>\n<li>srv：英语 service的缩写，表示”服务”。包含一些网络服务启动之后所需要取用的数据；</li>\n<li>tmp：英语 temporary 的缩写，表示”临时的”。普通用户和程序存放临时文件的地方；</li>\n<li>usr：英语 Unix Software Resource 的缩写，表示”Unix 操作系统软件资源”（也是个历史遗留的命名）。这个目录是最庞大的目录之一。有点类似 Windows 中的 C:\\Windows 和 C:\\Program Files 这两个文件夹的集合。在这里面安装了大部分用户要调用的程序；</li>\n<li>var：英语 variable 的缩写，表示”动态的，可变的”。通常包含程序的数据，比如一些 log（日志）文件，记录电脑中发生了什么事。 </li>\n</ul>\n<h3 id=\"pwd、which\"><a href=\"#pwd、which\" class=\"headerlink\" title=\"pwd、which\"></a>pwd、which</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">pwd 显示当前目录的路径 </span><br><span class=\"line\">[root@node1 ~]# pwd</span><br><span class=\"line\">&#x2F;root  </span><br><span class=\"line\">pwd 就是 print work directory,打印当前工作目录  </span><br><span class=\"line\"></span><br><span class=\"line\">which 获取命令可执行文件的位置  </span><br><span class=\"line\">[root@node1 ~]# which bash</span><br><span class=\"line\">&#x2F;usr&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ls、cd、du\"><a href=\"#ls、cd、du\" class=\"headerlink\" title=\"ls、cd、du\"></a>ls、cd、du</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ls 列出文件和目录  </span><br><span class=\"line\">ls -a 显示所有文件和目录，包括隐藏的  </span><br><span class=\"line\">ls -l 显示文件和目录详细信息列表  </span><br><span class=\"line\">ls -lh 适合人阅读的  </span><br><span class=\"line\">ls -lt 按最近修改时间排序显示  </span><br><span class=\"line\">ls -alht 综合使用</span><br></pre></td></tr></table></figure>\n<p>例子如图所示:<br><img src=\"/img/linux-2-2.png\" alt=\"\">  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd change directory ,切换目录   </span><br><span class=\"line\">[root@node1 ~]# cd testHadoop&#x2F;</span><br><span class=\"line\">[root@node1 testHadoop]# pwd</span><br><span class=\"line\">&#x2F;root&#x2F;testHadoop  </span><br><span class=\"line\"></span><br><span class=\"line\">相对路径</span><br><span class=\"line\">cd testHadoop testHadoop 位于root目录，如果退出了root目录，就不能再执行cd testHadoop  </span><br><span class=\"line\"></span><br><span class=\"line\"> 绝对路径  </span><br><span class=\"line\">[root@node1 home]# cd &#x2F;root&#x2F;testHadoop&#x2F;</span><br><span class=\"line\">[root@node1 testHadoop]# pwd</span><br><span class=\"line\">&#x2F;root&#x2F;testHadoop  </span><br><span class=\"line\"></span><br><span class=\"line\">重回家目录  </span><br><span class=\"line\">cd &#x2F;home&#x2F;husheng  或&#x2F;root  </span><br><span class=\"line\">cd ~  </span><br><span class=\"line\">cd  </span><br><span class=\"line\"></span><br><span class=\"line\">du disk usage的缩写，表示磁盘使用&#x2F;占用  </span><br><span class=\"line\">du -a 显示文件和目录的大小  </span><br><span class=\"line\">du -h 适合人阅读的  </span><br><span class=\"line\">du -s 只显示总计大小  </span><br><span class=\"line\">[root@node1 testHadoop]# du -ah</span><br><span class=\"line\">4.0K    .&#x2F;myFile.txt</span><br><span class=\"line\">4.0K    .</span><br><span class=\"line\">[root@node1 testHadoop]# du -hs</span><br><span class=\"line\">4.0K    .</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"less、cat显示文件内容\"><a href=\"#less、cat显示文件内容\" class=\"headerlink\" title=\"less、cat显示文件内容\"></a>less、cat显示文件内容</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">cat 命令一次性显示所有内容，  </span><br><span class=\"line\">cat 文件名，即可查看文件内容  </span><br><span class=\"line\">cat -n 文件内容显示加上行号</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/linux-2-4.png\" alt=\"\">  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">less 相较于cat不会全部显示，而是分页显示，more命令也类似功能，但是只能向前翻页，没法后退。  </span><br><span class=\"line\">cd &#x2F;usr&#x2F;log  </span><br><span class=\"line\">less yum.log  </span><br><span class=\"line\">常用快捷键：  </span><br><span class=\"line\">空格键：文件内容读取下一个终端屏幕的行数，相当于前进一个屏幕（页）。很常用的快捷键。与键盘上的 PageDown（下一页）效果一样；</span><br><span class=\"line\">回车键：文件内容读取下一行，也就是前进一行，与键盘上的向下键效果是一样的；</span><br><span class=\"line\">d 键：前进半页（半个屏幕）；</span><br><span class=\"line\">b 键：后退一页，与键盘上的 PageUp（上一页）效果一样；</span><br><span class=\"line\">y 键：后退一行，与键盘上的向上键效果是一样的；</span><br><span class=\"line\">u 键：后退半页（半个屏幕）；</span><br><span class=\"line\">q 键：停止读取文件，中止 less 命令。  </span><br><span class=\"line\">高级用法：  </span><br><span class=\"line\">&#x3D; 显示当前是多少行，总共多少行  </span><br><span class=\"line\">&#x2F; 进入搜索模式，按n键跳到下一个符合要求的位置， N跳转上一个位置</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/linux-2-5.png\" alt=\"\"><br><img src=\"/img/linux-2-6.png\" alt=\"\"><br><img src=\"/img/linux-2-7.png\" alt=\"\"></p>\n<h3 id=\"head与tail显示文件头和尾\"><a href=\"#head与tail显示文件头和尾\" class=\"headerlink\" title=\"head与tail显示文件头和尾\"></a>head与tail显示文件头和尾</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">head yum.log  显示文件头10行  </span><br><span class=\"line\">head -n yum.log 显示文件指定头n行  </span><br><span class=\"line\"></span><br><span class=\"line\">tail yum.log 显示文件尾10行  </span><br><span class=\"line\">tail -n yum.log 显示文件尾指定行数  </span><br><span class=\"line\">tail -f yum.log 实时跟踪yum.log更新，ctr + C 结束</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/linux-2-8.png\" alt=\"\"></p>\n<h3 id=\"touch与mkdir新建文件与文件夹\"><a href=\"#touch与mkdir新建文件与文件夹\" class=\"headerlink\" title=\"touch与mkdir新建文件与文件夹\"></a>touch与mkdir新建文件与文件夹</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">touch newfile 创建一个空文件  </span><br><span class=\"line\">touch newfile1 newfile2 创建多个文件  </span><br><span class=\"line\">mkdir newfolder 创建一个空文件夹  </span><br><span class=\"line\">mkdir newfolder1 newfolder2 创建多个文件夹  </span><br><span class=\"line\">mkdir -p &#x2F;husheng&#x2F;cnhk 递归创建子文件夹</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/linux-2-9.png\" alt=\"\"></p>\n<h3 id=\"文件的复制、移动、删除\"><a href=\"#文件的复制、移动、删除\" class=\"headerlink\" title=\"文件的复制、移动、删除\"></a>文件的复制、移动、删除</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">文件拷贝：  </span><br><span class=\"line\"> [root@izwz9853xzzbsd0y95igboz commoandLearn]# cp test.txt test1.txt  </span><br><span class=\"line\">文件拷贝到文件夹：  </span><br><span class=\"line\">[root@izwz9853xzzbsd0y95igboz commoandLearn]# cp test.txt test1.txt  </span><br><span class=\"line\">文件夹含子文件夹递归拷贝 -r：  </span><br><span class=\"line\">[root@izwz9853xzzbsd0y95igboz commoandLearn]# cp -r Adir Bdir&#x2F;  </span><br><span class=\"line\">使用通配符*</span><br><span class=\"line\">cp *.txt Adir&#x2F;  </span><br><span class=\"line\">文件移动：  </span><br><span class=\"line\">mv test.txt test2.txt  文件重名名  </span><br><span class=\"line\">mv test2.txt Adir&#x2F;  </span><br><span class=\"line\">文件和目录删除： </span><br><span class=\"line\">rm test.txt  </span><br><span class=\"line\">文件删除询问：  </span><br><span class=\"line\">rm -i test.txt  </span><br><span class=\"line\">强制删除：  </span><br><span class=\"line\">rm -f test.txt  </span><br><span class=\"line\">强制递归删除危险：</span><br><span class=\"line\">rm -rf Adir&#x2F;</span><br></pre></td></tr></table></figure>","tags":["linux","shell"]},{"title":"linux命令行与shell脚本学习1","url":"/2020/03/03/linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8Eshell%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A01/","content":"<h1 id=\"操作系统介绍\"><a href=\"#操作系统介绍\" class=\"headerlink\" title=\"操作系统介绍\"></a>操作系统介绍</h1><h2 id=\"操作系统定义\"><a href=\"#操作系统定义\" class=\"headerlink\" title=\"操作系统定义\"></a>操作系统定义</h2><ul>\n<li>从操作系统层往两侧看：负责管理协调硬件、软件等计算机资源的工作  </li>\n<li>从上往下看：为上层的应用程序和用户提供简单易用的服务 </li>\n<li>从下往上看：操作系统系统软件，而不是硬件  </li>\n</ul>\n<h2 id=\"电脑启动顺序\"><a href=\"#电脑启动顺序\" class=\"headerlink\" title=\"电脑启动顺序\"></a>电脑启动顺序</h2><ol>\n<li>启动界面  </li>\n<li>操作系统的启动</li>\n<li>其他程序(系统上的软件)的启动<br>示意图如图：<br><img src=\"/img/linux-1-1.jpg\" alt=\"\"></li>\n</ol>\n<p>启动界面的有一小段程序是运行在主板上的，也就是通常我们说的BIOS界面。如果装了双系统，启动时候，BootLoader会提示你做选择，选择哪个系统。<br>百度百科：<br>“Bootloader 是在操作系统内核运行之前运行的一段小程序。通过这段小程序，我们可以初始化硬件设备，建立内存空间的映射图，从而将系统的软硬件环境带到一个合适的状态，以便为最终调用操作系统内核准备好正确的环境。通常，Bootloader 是严重地依赖于硬件而实现的，特别是在嵌入式领域。”<br>双系统启动示意图：<br><img src=\"/img/linux-1-2.jpg\" alt=\"\">  </p>\n<h2 id=\"Linux操作系统\"><a href=\"#Linux操作系统\" class=\"headerlink\" title=\"Linux操作系统\"></a>Linux操作系统</h2><h3 id=\"什么是GNU\"><a href=\"#什么是GNU\" class=\"headerlink\" title=\"什么是GNU\"></a>什么是GNU</h3><p>GNU实际上是”GNU is Not Unix”,GNU是一个免费的操作系统，而且它还是自由的。<br>GNU项目的创建者是Richard Stallman;与他相关的主要有以下：  </p>\n<ul>\n<li>自由软件基金会(Free Software Fundation)的主席  </li>\n<li>GNU项目创始人，所写作的GNU通用公共许可证(GNU GPL)是采用最广泛的自由软件许可证。遵循一种CopyRight:可拷贝、可修改、可出售，但是改进和修改的源码必须向用户公开。保证了自由软件的传播性。</li>\n<li>主要作品：Emacs,GCC(GNU Compiler Collection,GNU编译器集合),GDB(GNU Project Debugger,GNU项目调试器)。  </li>\n<li>GNU项目首要目的是创建一个类Unix系统。 </li>\n</ul>\n<h3 id=\"Unix、GNU、Linux的关系\"><a href=\"#Unix、GNU、Linux的关系\" class=\"headerlink\" title=\"Unix、GNU、Linux的关系\"></a>Unix、GNU、Linux的关系</h3><ul>\n<li>Unix系统是一款商业操作系统  </li>\n<li>Linux系统是Linus Torvalds开发的类Unix操作系统。  </li>\n<li>GNU 项目（开源的各种程序）+ Linux （操作系统内核）= GNU/Linux 这一个完整的操作系统。  </li>\n</ul>\n<p>用一张图总结下他们的关系：<br><img src=\"/img/linux-1-3.jpg\" alt=\"\"></p>\n<h3 id=\"Linux发行版\"><a href=\"#Linux发行版\" class=\"headerlink\" title=\"Linux发行版\"></a>Linux发行版</h3><p>Linux系统是开源自由的，用户可以修改源码定制自己的系统。下面列举主要发行版：  </p>\n<ul>\n<li>RedHat:红帽，2018年被IBM高价收购；性能稳定，老牌的Linux发行版；目前主要两个系列：由RedHat公司提供收费的Redhat EnterPrise Linux,社区开发免费的Fedora Core。</li>\n<li>Fedora: Redhat的免费后继版。安装简单，更新频率快，不稳定。  </li>\n<li>CentOS：适用于服务器的 RedHat 版本是 RedHat Enterprise Linux（表示”红帽企业 Linux”，简称 RHEL），这是个收费的操作系统。CentOS 可以算是 RHEL 的克隆版，它最大的好处是免费。CentOS 是 Community Enterprise Operating System 的缩写，表示”社区企业操作系统”，兼顾社区与企业特性。稳定、长期更新、保守性被企业普遍使用。  </li>\n<li>DeBian：最早由 Ian Murdock 于 1993 年创建。可以算是迄今为止，最遵循 GNU 规范的 Linux 系统。Debian 系统分为三个版本分支（branch）：stable，testing 和 unstable。  </li>\n<li>Ubuntu：Debian 的后继或一个分支。</li>\n<li>Deepin：由武汉深之度科技有限公司开发的，为祖国自豪一下。易用。Deepin 不仅仅对最优秀的开源产品进行集成和配置，还开发了基于 HTML5 技术的全新桌面环境、系统设置中心、以及音乐播放器，视频播放器，软件中心等一系列面向日常使用的应用软件。  </li>\n<li>FreeBSD：首先要强调的是：FreeBSD 不是一个 Linux 系统！因为 FreeBSD 的用户也相当多，其许多特性都与 Linux 相类似。事实上，Linux 和 BSD（Berkeley Software Distribution）均是 Unix 的演化分支。并且，Linux 中相当多的特性和功能（比如用于配置 DNS 的 Bind 软件）都是取自于 BSD 的。而 FreeBSD 便是 BSD 家族中最出名，用户数量最多的一个发行版。苹果的 macOS 的内核 Darwin 以前也部分地借鉴了 FreeBSD。  </li>\n</ul>\n<p>用图表示各发行版的关系：<br><img src=\"/img/linux-1-4.jpg\" alt=\"\">  </p>\n","tags":["linux","shell"]},{"title":"基于gitee和hexo搭建个人博客","url":"/2020/02/23/%E5%9F%BA%E4%BA%8Egitee%E5%92%8Chexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","content":"<h3 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h3><p>最近折腾博客，开始采用github page方式的静态博客，但是考虑到国内访问GitHub速度慢且不稳定，故在原有GitHub和hexo(AirCloud搭建的博客基础上，迁移到码云Gitee上，这里有些坑提出来，供大家参考。参考博客：<a href=\"https://segmentfault.com/a/1190000018662692?utm_source=tag-newest\" target=\"_blank\" rel=\"noopener\">基于Gitee+Hexo搭建个人博客</a></p>\n<h3 id=\"环境搭建\"><a href=\"#环境搭建\" class=\"headerlink\" title=\"环境搭建\"></a>环境搭建</h3><p>打开hexo官网<a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\">hexo doc</a>;参照指南安装好node，git。注意国内访问npm镜像较慢，切换成淘宝镜像源，执行下面命令：<br>切换淘宝镜像<br><code>$ npm config set registry https://registry.npm.taobao.org</code><br>查看是否切换到淘宝镜像<br><code>$ npm info underscore</code>  </p>\n<h4 id=\"1、安装hexo\"><a href=\"#1、安装hexo\" class=\"headerlink\" title=\"1、安装hexo\"></a>1、安装hexo</h4><p>使用npm安装hexo<br><code>$ npm install -g hexo-cli</code><br>这里可能会出错，<a href=\"https://blog.csdn.net/sunxiaoju/article/details/102568075\" target=\"_blank\" rel=\"noopener\">参考链接</a>中的错误，cmd中输入命令行：<br><code>$ set-ExecutionPolicy RemoteSigned 选择A</code>  </p>\n<h4 id=\"2、建站\"><a href=\"#2、建站\" class=\"headerlink\" title=\"2、建站\"></a>2、建站</h4><p>hexo安装完后，执行下面命令：  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo init &lt;folder&gt;</span><br><span class=\"line\">$ cd &lt;folder&gt;</span><br><span class=\"line\">$ npm install</span><br></pre></td></tr></table></figure>\n<p>执行完后生成如下：  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── scaffolds</span><br><span class=\"line\">├── source</span><br><span class=\"line\">|   ├── _drafts</span><br><span class=\"line\">|   └── _posts</span><br><span class=\"line\">└── themes</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3、配置\"><a href=\"#3、配置\" class=\"headerlink\" title=\"3、配置\"></a>3、配置</h4><p>主要是在_config.yml修改属性<br>具体说明参考<a href=\"https://hexo.io/zh-cn/docs/configuration\" target=\"_blank\" rel=\"noopener\">hexo官方配置</a>，我使用的主题是<a href=\"https://github.com/aircloud/hexo-theme-aircloud\" target=\"_blank\" rel=\"noopener\">aircloud</a>,主题配置参考下面命令：  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ cd themes</span><br><span class=\"line\">$ git clone https:&#x2F;&#x2F;github.com&#x2F;aircloud&#x2F;hexo-theme-aircloud.git  </span><br><span class=\"line\">然后修改_config.yml中属性theme: hexo-theme-aircloud</span><br></pre></td></tr></table></figure>\n<p>我这里给出我主要的配置信息供参考：  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># Site</span><br><span class=\"line\">title: husheng3921</span><br><span class=\"line\">subtitle: Stay Hungry, Stay Foolish!</span><br><span class=\"line\">keywords:</span><br><span class=\"line\">author: Hu Sheng</span><br><span class=\"line\">language: zh</span><br><span class=\"line\">timezone: &#39;&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"># Site settings</span><br><span class=\"line\"># 网站综合内容设置：</span><br><span class=\"line\">SEOTitle: husheng3921的博客 | husheng3921&#39;s Blog</span><br><span class=\"line\">email: husheng3921@gmail.com</span><br><span class=\"line\">description: &quot;胡圣的博客&quot;</span><br><span class=\"line\"># keyword: &quot;腾讯&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># 头像图片地址</span><br><span class=\"line\">sidebar-avatar: img&#x2F;avatar.jpg</span><br><span class=\"line\">avatar_style:</span><br><span class=\"line\">  radius: true</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># search博客内容搜索</span><br><span class=\"line\">search:</span><br><span class=\"line\">  path: search.json</span><br><span class=\"line\">  field: post</span><br><span class=\"line\"></span><br><span class=\"line\"># SNS settings</span><br><span class=\"line\"># 一些社交平台地址，支持以下几种：</span><br><span class=\"line\">weibo_username:     5012869548</span><br><span class=\"line\">github_username:    husheng3921</span><br><span class=\"line\"># twitter_username:   iconie_alloy</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 评论</span><br><span class=\"line\">comment:</span><br><span class=\"line\">   type: disqus</span><br><span class=\"line\">   script: &#39;https:&#x2F;&#x2F;airclouds-blog.disqus.com&#x2F;embed.js&#39;</span><br><span class=\"line\"># Extensions</span><br><span class=\"line\">## Plugins: https:&#x2F;&#x2F;hexo.io&#x2F;plugins&#x2F;</span><br><span class=\"line\">## Themes: https:&#x2F;&#x2F;hexo.io&#x2F;themes&#x2F;</span><br><span class=\"line\">theme: hexo-theme-aircloud</span><br><span class=\"line\"></span><br><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  # gitee.com</span><br><span class=\"line\">  repo: https:&#x2F;&#x2F;gitee.com&#x2F;husheng3921&#x2F;husheng3921</span><br><span class=\"line\">  # repo: https:&#x2F;&#x2F;github.com&#x2F;husheng3921&#x2F;husheng3921.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4、命令\"><a href=\"#4、命令\" class=\"headerlink\" title=\"4、命令\"></a>4、命令</h4><p>主要有新建、本地运行、部署,<a href=\"https://hexo.io/zh-cn/docs/commands\" target=\"_blank\" rel=\"noopener\">详见</a>；  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo new [layout] &lt;filename&gt;  新建</span><br><span class=\"line\">hexo server  本地运行</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5、部署\"><a href=\"#5、部署\" class=\"headerlink\" title=\"5、部署\"></a>5、部署</h4><ul>\n<li>GitHub部署<br>在github新建仓库，<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">在_config.yml中修改  </span><br><span class=\"line\">deploy:</span><br><span class=\"line\">    repo: 新建的博客GitHub仓库地址</span><br><span class=\"line\">运行部署  </span><br><span class=\"line\">hexo clean  </span><br><span class=\"line\">hexo deploy。</span><br></pre></td></tr></table></figure></li>\n<li>Gitee上部署<br><strong>坑一</strong><br>在gitee上新建仓库时注意仓库名字要与你的Gitee账户一致，例如我的仓库名字husheng3921(与账户名一样),这样才能保证Gitee创建博客的域名就是<code>http://husheng3921.gitee.io</code>,否则后面会带有后缀，例如仓库名:blog，系统会生成<code>http://husheng3921.gitee.io/blog</code>,你还需要在_confiy.yml中root属性配置blog值。  <figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">在_config.yml中修改  </span><br><span class=\"line\">deploy:</span><br><span class=\"line\">    repo: 新建的博客gitee仓库地址</span><br><span class=\"line\">运行部署  </span><br><span class=\"line\">hexo clean  </span><br><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n点击博客仓库-服务-Gitee Pages<br><img src=\"/img/gitee1.png\" alt=\"\"><br><img src=\"/img/gitee2.jpg\" alt=\"\"><br>启动成功后如下<br><img src=\"/img/gitee3.jpg\" alt=\"\"><br><strong>坑二</strong><br>每次hexo deploy部署后，都要点击更新按钮，内容才回更新。这个比github上麻烦一点。 </li>\n</ul>\n<h3 id=\"末尾\"><a href=\"#末尾\" class=\"headerlink\" title=\"末尾\"></a>末尾</h3><p>距上一次在CSDN上写博客已经快3年了，上次写的也是入门级教程，感觉逻辑和语言还是有些小毛病，争取一次次改进，锻炼自己的书写能力，通过写博客来加深自己对知识的理解。</p>\n","tags":["git","入门"]},{"title":"Hello World","url":"/2020/02/23/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n"}]